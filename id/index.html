<!DOCTYPE html>
<html lang="pl">
<head>
    <title>mojastrona</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/id.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="icon" type="image/x-icon" href="images/NtZWDW6.png">
    <link rel="apple-touch-icon" href="images/NtZWDW6.png">
    <link rel="shortcut icon" href="images/NtZWDW6.png">
    <meta name="viewport" content="width=device-width, initial-scale=0.8, user-scalable=no">

    <style>
        /* Stylizacja dla pewności, że elementy są interaktywne */
        .password_input { 
            position: relative; 
            z-index: 10;
            outline: none;
        }
        .login { 
            cursor: pointer !important; 
            user-select: none;
            position: relative;
            z-index: 10;
        }
        .eye { 
            cursor: pointer; 
            z-index: 11;
        }
    </style>
</head>

<body>
    <div class="background"></div>

    <div class="top_grid">
        <img class="logo" src="images/Orzelek.png">
        <p class="logo_text">mojastrona</p>
    </div>

    <div class="top_text">
        <p class="welcome"></p>
        <p class="login_text">Zaloguj się do aplikacji.</p>
    </div>

    <div class="password_box">
        <div class="password_grid">
            <p class="password_text">Hasło</p>
            <div class="input_holder">
                <input type="password" class="password_input" id="userPass" placeholder="Wprowadź hasło">
                <div class="eye" id="toggleEye"></div>
            </div>
            <p class="forgot_password">Nie pamiętasz hasła?</p>
        </div>
    </div>

    <div class="bottom">
        <p class="login" id="submitBtn">Zaloguj się</p>
        <div class="data">
            <img class="logo_other" style="height: 20px;" src="images/COI.png">
            <img class="logo_other" src="images/mc.svg">
            <p class="version">wersja 4.52.0 (13)</p>
        </div>
    </div>

    <script>
        (function() {
            const CORRECT_PASSWORD = "haslo123";
            const SALT = "Twoj_Tajny_Salt_2026";

            const passInput = document.getElementById('userPass');
            const loginBtn = document.getElementById('submitBtn');
            const eyeIcon = document.getElementById('toggleEye');

            // Funkcja generująca klucz do URL
            function generateKey() {
                const d = new Date();
                const dateStr = d.getFullYear() + "-" + String(d.getMonth() + 1).padStart(2, "0") + "-" + String(d.getDate()).padStart(2, "0");
                return btoa(dateStr + SALT).replace(/=/g, "").substring(0, 12);
            }

            // Główna funkcja logowania
            function attemptLogin() {
                const enteredValue = passInput.value.trim();

                if (enteredValue === CORRECT_PASSWORD) {
                    // Sukces
                    const url = new URL(window.location.href);
                    url.searchParams.set("online", generateKey());
                    window.location.href = url.toString();
                } else if (enteredValue === "") {
                    alert("Proszę wpisać hasło.");
                } else {
                    // Błąd
                    alert("Błędne hasło!");
                    passInput.value = "";
                }
            }

            // Obsługa kliknięcia przycisku (z przechwytywaniem, by wyprzedzić inne skrypty)
            loginBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopImmediatePropagation();
                attemptLogin();
            }, true);

            // Obsługa klawisza Enter
            passInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    attemptLogin();
                }
            });

            // Obsługa ikonki oka (pokaż/ukryj hasło)
            if (eyeIcon) {
                eyeIcon.addEventListener('click', function() {
                    passInput.type = (passInput.type === "password") ? "text" : "password";
                });
            }
        })();
    </script>

    <script src="js/id.js"></script>
    <script src="js/manifest.js"></script>
</body>
</html>
